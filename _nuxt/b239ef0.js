(window.webpackJsonp=window.webpackJsonp||[]).push([[14,5],{278:function(t,e,r){"use strict";r.r(e);r(55);var o={name:"Alert",props:{message:{default:function(){return{}},type:Object}},data:function(){return{messages:[]}},watch:{message:function(){this.message.content&&this.addAlert()}},methods:{addAlert:function(){var t=this.message,style=t.style,e=t.icon,content=t.content;this.messages.push({style:style,icon:e,content:content}),this.removeAlert()},removeAlert:function(){var t=this;setTimeout((function(){t.messages.shift()}),6e3)}}},n=r(36),component=Object(n.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",t._l(t.messages,(function(e,o){return r("div",{key:o,staticClass:"alert mb-6 my-2",class:"alert-"+e.style,attrs:{role:"alert"}},[r("p",{staticClass:"mb-0"},[r("i",{staticClass:"pe-1 fas",class:e.icon}),t._v(t._s(e.content))])])})),0)}),[],!1,null,null,null);e.default=component.exports},279:function(t,e,r){t.exports=r.p+"img/week1.1822666.png"},280:function(t,e,r){t.exports=r.p+"img/week2.3ba5070.png"},281:function(t,e,r){t.exports=r.p+"img/week3.4b175ab.png"},282:function(t,e,r){t.exports=r.p+"img/week4.71c10bb.png"},288:function(t,e,r){"use strict";var o=r(6);r(56),r(41),r(27),r(38),r(39),r(47),r(55);e.a={data:function(){return{worksId:0,worksData:{},worksTypes:{tags:[]},worksSubmit:{creative_commons_id:0,stage_id:0,tag_ids:[]},cacheImg:[],msg:{},stageList:[{id:1,name:"Week1 - 台灣旅遊景點導覽",status:!1,startTime:"",endTime:"",nowTime:""},{id:2,name:"Week2 - 自行車道地圖資訊整合網",status:!1,startTime:"",endTime:"",nowTime:""},{id:3,name:"Week3 - 全台公車動態時刻查詢應用服務",status:!1,startTime:"",endTime:"",nowTime:""},{id:4,name:"Week4 - 薪資數據圖表調查",status:!1,startTime:"",endTime:"",nowTime:""}],teamstageList:{frontend:[{id:1,name:"Week1 - 台灣旅遊景點導覽",status:!1,startTime:"",endTime:"",nowTime:""},{id:2,name:"Week2 - 自行車道地圖資訊整合網",status:!1,startTime:"",endTime:"",nowTime:""},{id:3,name:"Week3 - 全台公車動態時刻查詢應用服務",status:!1,startTime:"",endTime:"",nowTime:""},{id:4,name:"Week4 - 薪資數據圖表調查",status:!1,startTime:"",endTime:"",nowTime:""}],ui:[{id:1,name:"Week1 - 台灣旅遊景點導覽",status:!1,startTime:"",endTime:"",nowTime:""},{id:2,name:"Week2 - 自行車道地圖資訊整合網",status:!1,startTime:"",endTime:"",nowTime:""},{id:3,name:"Week3 - 全台公車動態時刻查詢應用服務",status:!1,startTime:"",endTime:"",nowTime:""},{id:4,name:"Week4 - 薪資數據圖表調查",status:!1,startTime:"",endTime:"",nowTime:""}]},worksInfo:{},stageListNum:[]}},mounted:function(){this.getWorks(),this.$route.params.id&&(this.worksId=this.$route.params.id,this.getWork(this.worksId))},computed:{postStatus:function(){var t=this,e=!1;return this.stageList.filter((function(e){return e.id===t.worksSubmit.stage_id})).forEach((function(t){t.nowTime>=t.endTime&&(e=!0)})),e}},methods:{getWork:function(t){var e=this;this.$axios.get("/v1/users/works/".concat(t)).then((function(t){e.worksInfo=t.data.works_info,e.worksInfo&&(e.worksSubmit.stage_id=e.worksInfo.stage_id,e.worksSubmit.online_url=e.worksInfo.online_url,e.worksInfo.file_url&&(e.worksSubmit.file_url=e.worksInfo.file_url),e.$set(e.worksSubmit,"tag_ids",e.worksInfo.tags.map((function(t){return t.id}))),e.worksInfo.ui_layout_online_url&&(e.worksSubmit.ui_layout_online_url=e.worksInfo.ui_layout_online_url),e.worksSubmit.creative_commons_id=e.worksInfo.creative_commons_id,e.worksSubmit.description=e.worksInfo.description,e.cacheImg=e.worksInfo.images)}))},getWorks:function(){var t=this;this.$axios.get("/v1/dropdowns/works").then((function(e){t.worksData=e.data.dropdowns,t.worksData.works_types.forEach((function(e){e.id===t.roleId&&(t.worksTypes=e)}))})).then((function(){t.worksData.stage_schedule.forEach((function(e){t.stageList.forEach((function(r){e.id===r.id&&t.roleId===e.works_types_id&&(r.startTime=new Date(e.start_time).getTime()/1e3,r.endTime=new Date(e.end_time).getTime()/1e3,r.nowTime=Math.floor(Date.now()/1e3))})),t.teamstageList.ui.forEach((function(r){e.id===r.id&&t.roleId===e.works_types_id&&(r.startTime=new Date(e.start_time).getTime()/1e3,r.endTime=new Date(e.end_time).getTime()/1e3,r.nowTime=Math.floor(Date.now()/1e3))})),t.teamstageList.frontend.forEach((function(r){e.id===r.id&&t.roleId===e.works_types_id&&(r.startTime=new Date(e.start_time).getTime()/1e3,r.endTime=new Date(e.end_time).getTime()/1e3,r.nowTime=Math.floor(Date.now()/1e3))}))}))})).then((function(){t.stageList.forEach((function(t){t.nowTime<=t.startTime&&(t.status=!0)})),t.teamstageList.ui.forEach((function(t){t.nowTime<=t.startTime&&(t.status=!0)})),t.teamstageList.frontend.forEach((function(t){t.nowTime<=t.startTime&&(t.status=!0)}))})).then((function(){t.getUserWorksList()}))},submitWork:function(t){var e=this,r="/v1/works/submit",n="post";if(this.worksSubmit.works_type_id=this.roleId,t&&(r="/v1/users/works/".concat(this.worksId),n="put",delete this.worksSubmit.stage_id,delete this.worksSubmit.works_type_id,delete this.uiImgList),(1===this.worksSubmit.works_type_id||3===this.worksSubmit.works_type_id)&&!this.uiImgList.length)return alert("你缺少上傳設計稿圖片唷！");this.$axios[n](r,this.worksSubmit).then(function(){var r=Object(o.a)(regeneratorRuntime.mark((function r(o){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null===(n=e.uiImgList)||void 0===n||!n.length){r.next=3;break}return r.next=3,e.uploadImg(o.data.id);case 3:t&&(e.worksSubmit.stage_id=e.worksInfo.stage_id,e.worksSubmit.works_type_id=e.roleId),e.msg={style:"success",icon:"fa-check-circle",content:"投稿成功！"},setTimeout((function(){e.$router.push("/users/record")}),2e3);case 6:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}()).catch((function(t){var r,o;e.msg={style:"danger",icon:"fa-exclamation-triangle",content:(null===(r=t.response)||void 0===r||null===(o=r.data)||void 0===o?void 0:o.message)||"投稿失敗！"}}))},getUserWorksList:function(){var t=this;this.$axios.get("/v1/users/works").then((function(e){var r=e.data.works_list;if(t.stageListId=r.map((function(t){return{works_type_id:t.works_type_id,stage:t.stage_id}})),t.stageListId.some((function(t){return 1===t.works_type_id||2===t.works_type_id}))){var o=t.stageListId.map((function(t){return t.stage}));t.stageList.forEach((function(t){var e=o.indexOf(t.id);t.id===o[e]&&(t.status=!0)}))}else{var n=t.stageListId.filter((function(e){return e.works_type_id===t.roleId}));if(!n.length)return;var l="ui";4===t.roleId&&(l="frontend"),t.teamstageList[l].forEach((function(t){var e=n.map((function(t){return t.stage})).indexOf(t.id);-1!==e&&t.id===n[e].stage&&(t.status=!0)}))}}))}}}},291:function(t,e,r){var content=r(304);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(45).default)("02db59d2",content,!0,{sourceMap:!1})},303:function(t,e,r){"use strict";r(291)},304:function(t,e,r){var o=r(44)(!1);o.push([t.i,".tag:checked+span{color:#6b00ff;font-weight:400;border:1px solid #6b00ff;background-color:rgba(107,0,255,.2)!important}",""]),t.exports=o},307:function(t,e,r){"use strict";r.r(e);r(202),r(41);var o=r(74),n=r(288),l=r(278),d={name:"CreateFrontend",components:{ValidationObserver:o.a,ValidationProvider:o.b,Alert:l.default},mixins:[n.a],props:{nowRole:{default:"",type:String},roleId:{default:1,type:Number},editStatus:{default:!1,type:Boolean}},data:function(){return{works_list:[]}},computed:{filterWorks:function(){var t=this;return this.works_list.filter((function(e){return e.stage_id===t.worksSubmit.stage_id}))},defaultImg:function(){return 1===this.worksSubmit.stage_id?r(279):2===this.worksSubmit.stage_id?r(280):3===this.worksSubmit.stage_id?r(281):4===this.worksSubmit.stage_id?r(282):r(279)}},created:function(){this.getUsesData()},methods:{getUsesData:function(){var t=this;this.$axios.get("/v1/users/works/uses?page=1").then((function(e){t.works_list=e.data.works_list}))}}},m=(r(303),r(36)),component=Object(m.a)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Alert",{attrs:{message:t.msg}}),t._v(" "),r("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(e){var o=e.invalid;return[r("form",{staticClass:"row justify-content-center my-md-7",on:{submit:function(e){return e.preventDefault(),t.submitWork(t.editStatus)}}},[r("div",{staticClass:"col-md-4 order-md-0 order-1"},[r("h1",{staticClass:"fs-4 mb-4 text-black"},[t._v("投稿關卡 - "+t._s(t.nowRole))]),t._v(" "),r("ValidationProvider",{attrs:{rules:"excluded: 0"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("div",{staticClass:"mb-4"},[r("label",{staticClass:"form-label",attrs:{for:"weekLevel"}},[t._v("投稿關卡*")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.worksSubmit.stage_id,expression:"worksSubmit.stage_id"}],staticClass:"form-select mb-2",class:{"is-invalid":o[0]},attrs:{id:"weekLevel",name:"投稿關卡","aria-label":"投稿關卡下拉選單",disabled:t.editStatus||t.stageList.every((function(t){return t.status}))},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.worksSubmit,"stage_id",e.target.multiple?r:r[0])}}},[r("option",{domProps:{value:0}},[t._v("請選擇要投稿的關卡")]),t._v(" "),t._l(t.stageList,(function(e){return[!e.status||t.editStatus?r("option",{key:"stage"+e.id,domProps:{value:e.id}},[t._v(t._s(e.name))]):t._e()]}))],2),t._v(" "),r("span",{staticClass:"invalid-feedback"},[t._v(t._s(o[0]))]),t._v(" "),r("p",[!t.editStatus&&t.postStatus?r("small",{staticClass:"text-danger"},[t._v("已超過投稿時間，此關卡為挑戰失敗")]):t._e()])])]}}],null,!0)}),t._v(" "),r("div",{staticClass:"mb-4"},[r("label",{staticClass:"form-label d-block",attrs:{for:"skills"}},[t._v("使用技術")]),t._v(" "),t._l(t.worksTypes.tags,(function(e){return r("label",{key:e.id,staticClass:"btn btn-sm px-0",attrs:{name:e.name}},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.worksSubmit.tag_ids,expression:"worksSubmit.tag_ids"}],staticClass:"tag d-none",attrs:{id:"tag",type:"checkbox",name:"使用技術"},domProps:{value:e.id,checked:Array.isArray(t.worksSubmit.tag_ids)?t._i(t.worksSubmit.tag_ids,e.id)>-1:t.worksSubmit.tag_ids},on:{change:function(r){var o=t.worksSubmit.tag_ids,n=r.target,l=!!n.checked;if(Array.isArray(o)){var d=e.id,m=t._i(o,d);n.checked?m<0&&t.$set(t.worksSubmit,"tag_ids",o.concat([d])):m>-1&&t.$set(t.worksSubmit,"tag_ids",o.slice(0,m).concat(o.slice(m+1)))}else t.$set(t.worksSubmit,"tag_ids",l)}}}),t._v(" "),r("span",{staticClass:"badge border-transparent rounded-pill bg-light text-dark mb-1"},[t._v(t._s(e.name)+"\n            ")])])}))],2),t._v(" "),r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("div",{staticClass:"mb-4"},[r("label",{staticClass:"form-label",attrs:{for:"page_link"}},[t._v("線上觀看連結*")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.worksSubmit.online_url,expression:"worksSubmit.online_url"}],staticClass:"form-control",class:{"is-invalid":o[0]},attrs:{id:"page_link",name:"線上觀看連結",type:"text",placeholder:"https://codepen.io/..."},domProps:{value:t.worksSubmit.online_url},on:{input:function(e){e.target.composing||t.$set(t.worksSubmit,"online_url",e.target.value)}}}),t._v(" "),r("span",{staticClass:"invalid-feedback"},[t._v(t._s(o[0]))])])]}}],null,!0)}),t._v(" "),r("div",{staticClass:"mb-4"},[r("label",{staticClass:"form-label",attrs:{for:"repo_link"}},[t._v("原始檔位置")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.worksSubmit.file_url,expression:"worksSubmit.file_url"}],staticClass:"form-control",attrs:{id:"repo_link",type:"text",placeholder:"https://drive.google.com/..."},domProps:{value:t.worksSubmit.file_url},on:{input:function(e){e.target.composing||t.$set(t.worksSubmit,"file_url",e.target.value)}}})]),t._v(" "),r("ValidationProvider",{attrs:{rules:"required|max:150"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("div",{staticClass:"mb-4"},[r("label",{staticClass:"form-label",attrs:{for:"description"}},[t._v("作品描述（限制 150 字）*")]),t._v(" "),r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.worksSubmit.description,expression:"worksSubmit.description"}],staticClass:"form-control",class:{"is-invalid":o[0]},attrs:{id:"description",name:"作品描述",rows:"3"},domProps:{value:t.worksSubmit.description},on:{input:function(e){e.target.composing||t.$set(t.worksSubmit,"description",e.target.value)}}}),t._v(" "),r("span",{staticClass:"invalid-feedback"},[t._v(t._s(o[0]))])])]}}],null,!0)}),t._v(" "),r("ValidationProvider",{attrs:{rules:"excluded: 0"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("div",{staticClass:"mb-5"},[r("label",{staticClass:"form-label",attrs:{for:"cc"}},[t._v("\n              創用 CC*("),r("a",{attrs:{href:"http://creativecommons.tw/explore",target:"_blank"}},[t._v("版權說明")]),t._v(")\n            ")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.worksSubmit.creative_commons_id,expression:"worksSubmit.creative_commons_id"}],staticClass:"form-select",class:{"is-invalid":o[0]},attrs:{id:"cc",name:"創用 CC","aria-label":"創用 CC 下拉選單"},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.worksSubmit,"creative_commons_id",e.target.multiple?r:r[0])}}},[r("option",{domProps:{value:0}},[t._v("請選擇版權")]),t._v(" "),t._l(t.worksData.creative_commons,(function(e){return r("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])}))],2),t._v(" "),r("span",{staticClass:"invalid-feedback"},[t._v(t._s(o[0]))])])]}}],null,!0)}),t._v(" "),r("div",{staticClass:"d-grid"},[r("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:o}},[t._v("\n            "+t._s(t.editStatus?"編輯投稿":"投稿")+"\n          ")])])],1),t._v(" "),r("div",{staticClass:"col-md-4 order-md-1 order-0"},[t._l(t.filterWorks,(function(e){return r("div",{key:e.id},[r("div",[t._l(e.images,(function(image){return r("div",{key:image.id,staticClass:"mb-4"},[image.is_cover?r("div",[r("img",{staticClass:"img-fluid",attrs:{src:image.image_url,alt:""}})]):t._e()])})),t._v(" "),r("p",{staticClass:"mb-1"},[t._v("採用設計稿")]),t._v(" "),r("p",[t._v("已採用 "),r("a",{staticClass:"link-dark",attrs:{href:"/users/"+t.filterWorks[0].user_id,target:"_blank"}},[t._v(t._s(e.nickname)+" 的設計稿")])]),t._v(" "),r("small",{staticClass:"text-danger"},[t._v("投稿後無法更換採用的設計稿")])],2)])})),t._v(" "),t.filterWorks.length?t._e():r("div",[r("div",{staticClass:"mb-4"},[r("img",{staticClass:"img-fluid",attrs:{src:t.defaultImg,alt:""}})]),t._v(" "),r("p",[t._v("設計稿狀態"),r("small",{staticClass:"text-danger"})]),t._v(" "),r("p",{staticClass:"text-muted"},[t._v("未採用設計稿")]),t._v(" "),r("p",[r("small",{staticClass:"text-danger"},[r("i",{staticClass:"fas fa-exclamation-triangle"}),t._v(" 若有採用 UI 介面，請記得點擊採用，您的採用會是 UI 設計師的最大鼓勵！")])])])],2)])]}}])})],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Alert:r(278).default})}}]);