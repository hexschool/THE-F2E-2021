(window.webpackJsonp=window.webpackJsonp||[]).push([[37,5,10,12],{278:function(t,e,n){"use strict";n.r(e);n(55);var r={name:"Alert",props:{message:{default:function(){return{}},type:Object}},data:function(){return{messages:[]}},watch:{message:function(){this.message.content&&this.addAlert()}},methods:{addAlert:function(){var t=this.message,style=t.style,e=t.icon,content=t.content;this.messages.push({style:style,icon:e,content:content}),this.removeAlert()},removeAlert:function(){var t=this;setTimeout((function(){t.messages.shift()}),6e3)}}},o=n(36),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.messages,(function(e,r){return n("div",{key:r,staticClass:"alert mb-6 my-2",class:"alert-"+e.style,attrs:{role:"alert"}},[n("p",{staticClass:"mb-0"},[n("i",{staticClass:"pe-1 fas",class:e.icon}),t._v(t._s(e.content))])])})),0)}),[],!1,null,null,null);e.default=component.exports},283:function(t,e,n){var content=n(286);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(45).default)("7efe9a53",content,!0,{sourceMap:!1})},285:function(t,e,n){"use strict";n(283)},286:function(t,e,n){var r=n(44)(!1);r.push([t.i,'.avatar[data-v-2592f4a9]{font-family:"Lato",sans-serif;width:128px;height:128px;display:block;position:relative;transition:border .15s ease-in}.avatar .edit-avatar[data-v-2592f4a9]{background:var(--bs-white);width:40px;height:40px;border-radius:50%;right:0;display:flex;align-items:center;justify-content:center;text-decoration:none;cursor:pointer}.avatar .edit-avatar[data-v-2592f4a9]:hover{background:var(--bs-gray-200)}.avatar img[data-v-2592f4a9]{-o-object-fit:cover;object-fit:cover;border-radius:50%}.list-group-item[data-v-2592f4a9]{background-color:transparent;border:0}.list-group-item.nuxt-link-exact-active[data-v-2592f4a9],.list-group-item[data-v-2592f4a9]:hover{color:var(--bs-dark);background-color:var(--bs-gray-300)}.bg-gray-200[data-v-2592f4a9]{background-color:var(--bs-gray-200)}',""]),t.exports=r},289:function(t,e,n){"use strict";n.r(e);n(17),n(37),n(94),n(9),n(55);var r={name:"Sidebar",props:{info:{default:function(){return{}},type:Object}},data:function(){return{defaultImg:"",imageSrc:"",user:{avatar:"",individual_competition:{name:""}},msg:""}},computed:{defaultImage:function(){var t,e;return"個人組/前端工程師"===(null===(t=this.info.individual_competition)||void 0===t?void 0:t.name)?n(203):"個人組/UI設計師"===(null===(e=this.info.individual_competition)||void 0===e?void 0:e.name)?n(204):n(205)}},watch:{info:{handler:function(){this.user.avatar="",this.user.avatar=this.info.avatar},deep:!0}},methods:{editAvatar:function(){var t=this,e=document.querySelector("input[type=file]").files[0],n=new FileReader;n.onload=function(e){var n=e.target.result.split(",")[1];if(n.length<1048576){t.$nuxt.$loading.start();t.$axios.post("/v1/users/info/avatar",{avatar:n}).then((function(e){t.user.avatar=e.data.avatar_url,t.msg={style:"success",icon:"fa-check-circle",content:"已更新成功！頭貼將於四小時內至一日內更新"},t.$emit("alert",t.msg),setTimeout((function(){window.location.reload()}),2e3)})).catch((function(e){t.msg={style:"danger",icon:"fa-exclamation-triangle",content:e.response.data.message||"更新失敗！"},t.$emit("alert",t.msg)})).finally((function(){t.$nuxt.$loading.finish()}))}else alert("圖片大小超過限制，圖片限制為 1 MB。")},n.onerror=function(t){alert(t)},n.readAsDataURL(e)}}},o=(n(285),n(36)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-md-4 mb-5 mb-md-0"},[n("div",{staticClass:"bg-light py-6 px-6"},[n("div",{staticClass:"avatar mb-2 mx-auto"},[t._m(0),t._v(" "),n("input",{staticStyle:{visibility:"hidden",height:"0px",display:"block"},attrs:{id:"edit-avatar",type:"file",accept:".png,.jpg,.jpeg"},on:{change:t.editAvatar}}),t._v(" "),n("img",{staticClass:"w-100 h-100 d-block",attrs:{src:t.user.avatar||t.defaultImage,alt:"個人頭貼"}})]),t._v(" "),n("div",{staticClass:"text-center"},[n("small",{staticClass:"text-danger"},[t._v("圖片限制檔案大小為 1 MB")]),t._v(" "),n("p",{staticClass:"fw-bold mb-1"},[t._v(t._s(t.info.nickname))]),t._v(" "),n("p",{staticClass:"mb-2"},[t._v(t._s(t.info.email))]),t._v(" "),t.info.individual_competition?n("p",{staticClass:"d-inline-block bg-white py-1 px-3 mb-2"},[t._v("\n        "+t._s(t.info.individual_competition.name.replace("/","｜"))+"\n      ")]):t._e(),t._v(" "),t.info.team_competition?n("p",{staticClass:"d-inline-block bg-white py-1 px-3 mb-2"},[t._v("\n        "+t._s(t.info.team_competition.name.replace("/","｜"))+"\n      ")]):t._e(),t._v(" "),t.info.medal_name?n("p",[n("img",{staticClass:"pe-1",attrs:{src:t.info.medal_image_url,alt:"徽章"}}),t._v("\n        "+t._s(t.info.medal_name)+"\n      ")]):t._e(),t._v(" "),n("hr")]),t._v(" "),n("div",{staticClass:"list-group mb-5 mt-5 bg-gray-200 p-4 rounded-0"},[n("nuxt-link",{staticClass:"list-group-item list-group-item-action p-4",attrs:{to:"/users/prepare"}},[n("i",{staticClass:"fas fa-grin"}),t._v(" 賽前準備")]),t._v(" "),n("nuxt-link",{staticClass:"list-group-item list-group-item-action p-4",attrs:{to:"/users"}},[n("i",{staticClass:"fas fa-edit"}),t._v(" 編輯個人資料")]),t._v(" "),n("nuxt-link",{staticClass:"list-group-item list-group-item-action p-4",attrs:{to:"/users/record"}},[n("i",{staticClass:"fas fa-file-alt"}),t._v(" 投稿紀錄\n      ")])],1),t._v(" "),n("div",{staticClass:"d-grid"},[n("nuxt-link",{staticClass:"btn btn-primary",class:{disabled:!t.info.user_id},attrs:{to:"/users/"+t.info.user_id,target:"_blank"}},[t._v("查看個人公開頁面")])],1)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("label",{staticClass:"edit-avatar position-absolute",attrs:{for:"edit-avatar"}},[e("i",{staticClass:"fas fa-pencil-alt text-dark"})])}],!1,null,"2592f4a9",null);e.default=component.exports},338:function(t,e,n){"use strict";n.r(e);n(39),n(47),n(37),n(94),n(17);var r=n(74),o=n(278),l={name:"UserEditInner",components:{ValidationObserver:r.a,ValidationProvider:r.b,Alert:o.default},props:{info:{default:function(){return{}},type:Object}},data:function(){return{user:{description:"",facebook_url:""},password:"",reset:{old_password:"",new_password:"",confirm_new_password:""},group:{individual_competition_id:1,position_id:1,email:""},individual_competitions:{},team_competition_positions:{},msg:{},modal:""}},watch:{info:{handler:function(){this.user.description=this.info.description?this.info.description:"",this.user.facebook_url=this.info.facebook_url?this.info.facebook_url:"",this.info.individual_competition&&("前端工程師"===this.info.individual_competition.name.split("/")[1]?this.group.individual_competition_id=2:this.group.individual_competition_id=1),this.info.team_competition&&("UI設計師"===this.info.team_competition.postition_name&&(this.group.position_id=1),"前端工程師"===this.info.team_competition.postition_name&&(this.group.position_id=2),"其他"===this.info.team_competition.postition_name&&(this.group.position_id=3))},deep:!0}},mounted:function(){this.getSignupGroup()},methods:{editUserInfo:function(){var t=this;this.$axios.put("/v1/users/info",this.user).then((function(){t.$emit("edit"),t.msg={style:"success",icon:"fa-check-circle",content:"已更新成功！"}})).catch((function(e){t.msg={style:"danger",icon:"fa-exclamation-triangle",content:e.response.data.message||"更新失敗！"}}))},editPassword:function(){var t=this;this.$axios.put("/v1/users/password",this.reset).then((function(){t.msg={style:"success",icon:"fa-check-circle",content:"已更新成功！"},t.reset=t.$options.data().reset,t.$nextTick((function(){t.$refs.observer.reset()}))})).catch((function(e){t.msg={style:"danger",icon:"fa-exclamation-triangle",content:e.response.data.message||"更新失敗！"}}))},getSignupGroup:function(){var t=this;this.$axios.get("/v1/dropdowns/signup-info").then((function(e){t.individual_competitions=e.data.individual_competitions,t.team_competition_positions=e.data.team_competition_positions})).catch((function(){}))}}},c=n(36),component=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-md-6"},[n("Alert",{attrs:{message:t.msg}}),t._v(" "),n("h1",{staticClass:"fs-4 text-black mb-5"},[t._v("編輯個人資料")]),t._v(" "),n("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},[t.info.team_competition?[n("li",{staticClass:"nav-item",attrs:{role:"presentation"}},[n("button",{staticClass:"nav-link",class:{active:t.info.team_competition},attrs:{id:"teamProfile-tab","data-bs-toggle":"tab","data-bs-target":"#teamProfile",type:"button",role:"tab","aria-controls":"teamProfile","aria-selected":"true"}},[t._v("\n          修改團體資料\n        ")])])]:t._e(),t._v(" "),n("li",{staticClass:"nav-item",attrs:{role:"presentation"}},[n("button",{staticClass:"nav-link",class:{active:!t.info.team_competition},attrs:{id:"profile-tab","data-bs-toggle":"tab","data-bs-target":"#profile",type:"button",role:"tab","aria-controls":"profile","aria-selected":"false"}},[t._v("\n        修改個人資料\n      ")])]),t._v(" "),t._m(0)],2),t._v(" "),n("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[n("div",{staticClass:"tab-pane fade pt-5",class:{"show active":t.info.team_competition},attrs:{id:"teamProfile",role:"tabpanel","aria-labelledby":"teamProfile-tab"}},[n("ValidationObserver",[n("form",[t.info.team_competition?n("div",{staticClass:"mt-5"},[n("p",[t._v("團隊名稱："+t._s(t.info.team_competition.name))]),t._v(" "),t._l(t.info.team_competition.members,(function(e,r){return n("div",{key:"member"+r,staticClass:"mb-4"},[e.is_leader?n("div",[n("p",{staticClass:"mb-0"},[t._v("組長：")]),t._v(" "),e.nickname?n("p",{staticClass:"mb-0"},[n("a",{staticClass:"link-primary",attrs:{target:"_blank",href:"/users/"+e.user_id}},[t._v("\n                    "+t._s(e.nickname)+" / "+t._s(e.postition_name)+"\n                  ")]),t._v(" "),n("span",{staticClass:"text-dark"},[t._v("(\n                    "+t._s(e.is_verify?"驗證成功":"尚未完成信箱驗證")+"\n                    )")])]):t._e()]):e.nickname?n("div",[n("p",{staticClass:"mb-0"},[t._v("組員：")]),t._v(" "),n("p",{staticClass:"mb-0"},[n("a",{staticClass:"link-primary",attrs:{target:"_blank",href:"/users/"+e.user_id}},[t._v("\n                    "+t._s(e.nickname)+" / "+t._s(e.postition_name)+"\n                  ")]),t._v(" "),n("span",{staticClass:"text-dark"},[t._v("(\n                    "+t._s(e.is_verify?"驗證成功":"尚未完成信箱驗證")+"\n                    )")])])]):n("div",[n("p",{staticClass:"mb-0"},[t._v("尚未註冊 F2E 系統的組員：")]),t._v(" "),n("p",{staticClass:"mb-0"},[t._v("\n                  "+t._s(e.email)+"\n                ")])])])}))],2):t._e()])])],1),t._v(" "),n("div",{staticClass:"tab-pane fade pt-5",class:{"show active":!t.info.team_competition},attrs:{id:"profile",role:"tabpanel","aria-labelledby":"profile-tab"}},[n("div",{staticClass:"mt-5"},[n("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(e){var r=e.invalid;return[n("form",{on:{submit:function(e){return e.preventDefault(),t.editUserInfo.apply(null,arguments)}}},[n("ValidationProvider",{attrs:{rules:"max:150"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors;return[n("div",{staticClass:"mb-4"},[n("label",{staticClass:"form-label",attrs:{for:"description"}},[t._v("個人簡介（限制 150 字）")]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.user.description,expression:"user.description",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":r[0]},attrs:{id:"description",name:"個人簡介",rows:"3"},domProps:{value:t.user.description},on:{input:function(e){e.target.composing||t.$set(t.user,"description",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),n("span",{staticClass:"invalid-feedback"},[t._v(t._s(r[0]))])])]}}],null,!0)}),t._v(" "),n("ValidationProvider",{attrs:{rules:{regex:new RegExp("(?:(?:http|https)://)?(?:www.)?facebook.com/\\w*")}},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors;return[n("div",{staticClass:"mb-4"},[n("label",{staticClass:"form-label",attrs:{for:"fb_link"}},[t._v("Facebook 個人連結")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.user.facebook_url,expression:"user.facebook_url",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":r[0]},attrs:{id:"fb_link",name:"Facebook 個人連結",type:"text",placeholder:"https://www.facebook.com/"},domProps:{value:t.user.facebook_url},on:{input:function(e){e.target.composing||t.$set(t.user,"facebook_url",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),n("span",{staticClass:"invalid-feedback"},[t._v(t._s(r[0]))])])]}}],null,!0)}),t._v(" "),n("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:r}},[t._v("\n              更新資訊\n            ")])],1)]}}])})],1)]),t._v(" "),n("div",{staticClass:"tab-pane fade",attrs:{id:"resetPassword",role:"tabpanel","aria-labelledby":"reset_password-tab"}},[n("ValidationObserver",{ref:"observer",scopedSlots:t._u([{key:"default",fn:function(e){var r=e.invalid;return[n("form",{ref:"form",on:{submit:function(e){return e.preventDefault(),t.editPassword.apply(null,arguments)}}},[n("ValidationProvider",{attrs:{rules:"password"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors;return[n("div",{staticClass:"mb-4 pt-5"},[n("label",{staticClass:"form-label",attrs:{for:"old_password"}},[t._v("舊密碼")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.reset.old_password,expression:"reset.old_password",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":r[0]},attrs:{id:"old_password",name:"舊密碼",type:"password"},domProps:{value:t.reset.old_password},on:{input:function(e){e.target.composing||t.$set(t.reset,"old_password",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),n("span",{staticClass:"invalid-feedback"},[t._v(t._s(r[0]))])])]}}],null,!0)}),t._v(" "),n("ValidationProvider",{attrs:{rules:"password",vid:"confirmation"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors;return[n("div",{staticClass:"mb-4"},[n("label",{staticClass:"form-label",attrs:{for:"password"}},[t._v("新密碼")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.reset.new_password,expression:"reset.new_password",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":r[0]},attrs:{id:"password",name:"密碼",type:"password"},domProps:{value:t.reset.new_password},on:{input:function(e){e.target.composing||t.$set(t.reset,"new_password",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),n("span",{staticClass:"invalid-feedback"},[t._v(t._s(r[0]))])])]}}],null,!0)}),t._v(" "),n("ValidationProvider",{attrs:{rules:"required|confirmed:confirmation"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors;return[n("div",{staticClass:"mb-4"},[n("label",{staticClass:"form-label",attrs:{for:"confirm_password"}},[t._v("確認新密碼")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.reset.confirm_new_password,expression:"reset.confirm_new_password",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":r[0]},attrs:{id:"confirm_password",name:"確認密碼",type:"password"},domProps:{value:t.reset.confirm_new_password},on:{input:function(e){e.target.composing||t.$set(t.reset,"confirm_new_password",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),n("span",{staticClass:"invalid-feedback"},[t._v(t._s(r[0]))])])]}}],null,!0)}),t._v(" "),n("button",{staticClass:"btn btn-primary",attrs:{disabled:r}},[t._v("\n            更新密碼\n          ")])],1)]}}])})],1)])],1)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"nav-item",attrs:{role:"presentation"}},[n("button",{staticClass:"nav-link",attrs:{id:"resetPassword-tab","data-bs-toggle":"tab","data-bs-target":"#resetPassword",type:"button",role:"tab","aria-controls":"resetPassword","aria-selected":"false"}},[t._v("\n        變更密碼\n      ")])])}],!1,null,null,null);e.default=component.exports;installComponents(component,{Alert:n(278).default})},424:function(t,e,n){"use strict";n.r(e);n(17);var r=n(289),o=n(338),l=n(278),c={name:"User",components:{Sidebar:r.default,Edit:o.default,Alert:l.default},middleware:"routerAuth",meta:{requiresAuth:!0},data:function(){return{user:{},msg:{}}},mounted:function(){this.getUserInfo()},methods:{getUserInfo:function(){var t=this;this.$axios.get("/v1/users/info").then((function(e){t.user=e.data.user_info,window.sessionStorage.setItem("HbPeShUserVmYTyPe",t.user.individual_competition.name)})).catch((function(){}))},getSidebarAlertMsg:function(t){this.msg=t}}},d=n(36),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container py-5"},[n("div",{staticClass:"row justify-content-center"},[n("div",{staticClass:"col-lg-8 col-10"},[n("Alert",{attrs:{message:t.msg}})],1)]),t._v(" "),n("div",{staticClass:"row justify-content-center mt-md-7"},[n("Sidebar",{attrs:{info:t.user},on:{edit:t.getUserInfo,alert:t.getSidebarAlertMsg}}),t._v(" "),n("Edit",{attrs:{info:t.user},on:{edit:t.getUserInfo}})],1)])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Alert:n(278).default})}}]);